<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMC Smart Road | AI Reporting</title>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Framer Motion for Animations -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            margin: 0;
            overflow-x: hidden;
            background: #0f172a;
            color: white;
            font-family: 'Inter', sans-serif;
        }
        
        /* Animated Background */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(45deg, #0f172a, #1e293b, #0f172a);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Glassmorphism Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        /* 3D Tilt Effect */
        .tilt-container {
            perspective: 1000px;
            transform-style: preserve-3d;
        }
        
        .tilt-element {
            transition: transform 0.1s ease-out;
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion } = window.Motion;

        function App() {
            const [image, setImage] = useState(null);
            const [location, setLocation] = useState({ lat: null, lng: null, status: 'Detecting...' });
            const [aiStatus, setAiStatus] = useState('idle'); // idle, analyzing, success
            const [aiResult, setAiResult] = useState(null);
            const cardRef = useRef(null);

            // 3D Tilt Effect Logic
            const handleMouseMove = (e) => {
                if (!cardRef.current) return;
                const card = cardRef.current;
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const rotateX = ((y - centerY) / centerY) * -5; // Max 5deg rotation
                const rotateY = ((x - centerX) / centerX) * 5;

                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            };

            const handleMouseLeave = () => {
                if (cardRef.current) {
                    cardRef.current.style.transform = `perspective(1000px) rotateX(0deg) rotateY(0deg)`;
                }
            };

            // Geolocation
            useEffect(() => {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (pos) => setLocation({ 
                            lat: pos.coords.latitude.toFixed(6), 
                            lng: pos.coords.longitude.toFixed(6), 
                            status: 'Located' 
                        }),
                        (err) => setLocation({ ...location, status: 'Location Access Denied' })
                    );
                } else {
                    setLocation({ ...location, status: 'Not Supported' });
                }
            }, []);

            // Handle Image Upload
            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setImage(e.target.result);
                        analyzeImageWithAI(file);
                    };
                    reader.readAsDataURL(file);
                }
            };

            // ‚ö°Ô∏è LIGHTNING AI INTEGRATION ‚ö°Ô∏è
            const analyzeImageWithAI = async (file) => {
                setAiStatus('analyzing');
                
                // ---------------------------------------------------------
                // TODO: PASTE YOUR LIGHTNING.AI API CODE HERE
                // ---------------------------------------------------------
                // Example:
                // const formData = new FormData();
                // formData.append('image', file);
                // const response = await fetch('YOUR_LIGHTNING_AI_URL', { method: 'POST', body: formData });
                // const data = await response.json();
                // ---------------------------------------------------------

                // SIMULATION (Remove this when you add real API)
                setTimeout(() => {
                    setAiStatus('success');
                    setAiResult({
                        severity: 'High (Critical)',
                        type: 'Deep Pothole',
                        confidence: '98.5%'
                    });
                }, 2500);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4" onMouseMove={handleMouseMove} onMouseLeave={handleMouseLeave}>
                    <div 
                        ref={cardRef}
                        className="tilt-element glass-card w-full max-w-md rounded-2xl p-8 text-center relative overflow-hidden"
                    >
                        {/* Glow Effect */}
                        <div className="absolute -top-20 -left-20 w-40 h-40 bg-blue-500 rounded-full mix-blend-screen filter blur-3xl opacity-30 animate-pulse"></div>

                        <header className="mb-8 relative z-10">
                            <div className="inline-block p-3 rounded-full bg-blue-500/20 mb-4 border border-blue-400/30">
                                <span className="text-3xl">üõ£Ô∏è</span>
                            </div>
                            <h1 className="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-200 to-white">
                                SMC Smart Road
                            </h1>
                            <p className="text-blue-200/60 text-sm mt-1">AI-Powered Damage Detection</p>
                        </header>

                        <div className="space-y-6 relative z-10">
                            {/* Upload Area */}
                            {!image ? (
                                <label className="block w-full aspect-video rounded-xl border-2 border-dashed border-white/20 flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-all group">
                                    <div className="p-4 rounded-full bg-white/5 group-hover:scale-110 transition-transform mb-3">
                                        <svg className="w-8 h-8 text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                    </div>
                                    <span className="text-white/70 font-medium">Tap to Scan Road</span>
                                    <input type="file" className="hidden" accept="image/*" capture="environment" onChange={handleImageUpload} />
                                </label>
                            ) : (
                                <div className="relative rounded-xl overflow-hidden border border-white/10 shadow-2xl">
                                    <img src={image} className="w-full object-cover h-48" />
                                    {aiStatus === 'analyzing' && (
                                        <div className="absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-sm">
                                            <div className="text-center">
                                                <div className="w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-3"></div>
                                                <p className="text-blue-200 font-mono text-sm animate-pulse">ANALYZING GEOMETRY...</p>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Results Section */}
                            {aiResult && (
                                <div className="bg-green-500/10 border border-green-500/30 rounded-xl p-4 text-left animate-fade-in-up">
                                    <div className="flex justify-between items-center mb-2">
                                        <span className="text-green-300 font-bold flex items-center gap-2">
                                            ‚úÖ VERIFIED DAMAGE
                                        </span>
                                        <span className="text-xs bg-green-500/20 text-green-200 px-2 py-1 rounded">
                                            {aiResult.confidence}
                                        </span>
                                    </div>
                                    <div className="space-y-1 text-sm text-green-100/80">
                                        <p>Type: <span className="text-white">{aiResult.type}</span></p>
                                        <p>Severity: <span className="text-red-300 font-bold">{aiResult.severity}</span></p>
                                    </div>
                                </div>
                            )}

                            {/* Location Badge */}
                            <div className="flex items-center justify-center gap-2 text-xs text-white/40 bg-black/20 py-2 rounded-lg">
                                <span>üìç</span>
                                {location.lat && location.lng ? (
                                    <span className="font-mono">{location.lat}, {location.lng}</span>
                                ) : (
                                    <span>{location.status}</span>
                                )}
                            </div>

                            {/* Submit Button */}
                            <button 
                                className="w-full py-4 bg-gradient-to-r from-blue-600 to-blue-500 rounded-xl font-bold text-white shadow-lg shadow-blue-500/30 hover:shadow-blue-500/50 hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                                disabled={!aiResult}
                                onClick={() => alert("Report Sent to SMC Dashboard!")}
                            >
                                {aiResult ? "SUBMIT OFFICIAL REPORT" : "Waiting for Analysis..."}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
